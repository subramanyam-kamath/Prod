name: Executing GitHub Actions on Develop
run-name: ${{ github.actor }} is validating the Deployment on the ${{github.ref_name}}
on:
  push:
    branches:
      - "main"
    paths:
      - 'automations/**'
      
jobs:
    identify_and_store_deleted_files:
     runs-on: ubuntu-latest
     steps:
       - uses: devforce/setup-node@v3.5.1
         with:
          node-version: "18"
    
       - name: "Install Salesforce CLI"
         run: |
          wget https://developer.salesforce.com/media/salesforce-cli/sfdx/channels/stable/sfdx-linux-x64.tar.xz
          mkdir ~/sfdx
          tar xJf sfdx-linux-x64.tar.xz -C ~/sfdx --strip-components 1
          echo "$HOME/sfdx/bin" >> $GITHUB_PATH
          ~/sfdx/bin/sfdx version
          
       - name: Checkout code
       - uses: actions/checkout@v2
         with:
                fetch-depth: 0 
                
       
       - name: Deploy destructive changes
         run: sf project deploy start --dry-run --source-dir deleted_files --test-level NoTestRun
